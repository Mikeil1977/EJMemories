<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title id="docTitle">Share a Memory</title>
  <style>
    :root { --bg:#0f172a; --card:#111827; --text:#e5e7eb; --muted:#94a3b8; --accent:#38bdf8; }
    *{box-sizing:border-box} body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;background:linear-gradient(135deg,var(--bg),#111827)}
    .wrap{min-height:100dvh;display:grid;place-items:center;padding:24px}
    .card{width:min(720px,100%);background:rgba(17,24,39,.8);backdrop-filter:saturate(160%) blur(6px);border:1px solid rgba(148,163,184,.2);border-radius:20px;padding:28px;box-shadow:0 10px 40px rgba(0,0,0,.45)}
    h1{margin:0 0 6px;color:var(--text);font-weight:700;font-size:clamp(1.4rem,2.6vw,2rem)}
    p{color:var(--muted);line-height:1.6;margin:.35rem 0}
    .btns{display:grid;grid-template-columns:1fr;gap:14px;margin:20px 0}
    .btn{display:flex;align-items:center;justify-content:center;text-decoration:none;border:1px solid rgba(148,163,184,.3);border-radius:14px;padding:16px 18px;font-weight:600}
    .primary{background:var(--accent);color:#0b1220;border-color:transparent}
    .secondary{background:transparent;color:var(--text)}
    .disabled{opacity:.55;pointer-events:none}
    small{color:var(--muted)}
    .foot{margin-top:16px;display:flex;flex-direction:column;gap:10px}
    .hidden{display:none}
    .pass{display:flex;gap:10px;margin:12px 0}
    .pass input{flex:1;border:1px solid rgba(148,163,184,.35);background:#0b1220;color:var(--text);border-radius:10px;padding:12px}
    .pass button{border:0;background:var(--accent);color:#061019;font-weight:700;border-radius:10px;padding:0 14px}
    .hint{margin-top:8px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card" id="gate">
      <h1 id="gateTitle">Share a Memory</h1>
      <p id="gateIntro"></p>
      <div class="pass">
        <input id="pw" type="password" placeholder="Passphrase" autocomplete="off" />
        <button id="enter">Enter</button>
      </div>
      <small id="gateTip"></small>
    </div>

    <div class="card hidden" id="content">
      <h1 id="thanksTitle">Thank you for sharing a memory</h1>
      <p id="thanksIntro"></p>

      <div class="btns">
        <a class="btn primary" id="smsBtn" href="#"></a>
        <a class="btn secondary" id="mailBtn" href="#"></a>
      </div>

      <p class="hint hidden" id="desktopHint"><small></small></p>

      <p><small id="consentLine"></small></p>

      <div class="foot">
        <small id="fallbackLead"></small>
        <small><strong id="labelText"></strong> <span id="prettyPhone"></span></small>
        <small><strong id="labelEmail"></strong> <span id="prettyEmail"></span></small>
      </div>
    </div>
  </div>

  <script>
    // ======== EDIT HERE (everything else updates automatically) =========
    const PERSON       = "Emmie-Jane";                // Deceased's name
    const CONTACT_NAME = "Mike";                      // Your name (for on-screen text)
    const PASS         = "cullen-bay-glitter";        // Passphrase
    const PHONE        = "+447866533165";             // Your number (E.164)
    const EMAIL        = "mike.dalziel+ejstories@gmail.com"; // Inbox you manage

    // Optional copy tweaks (change if you want different wording)
    const STRINGS = {
      gateIntro: `This private page lets you send ${CONTACT_NAME} a story or photo about ${PERSON}. Please enter the passphrase from the order of service.`,
      gateTip: "Tip: If you can’t find it, ask a member of the family for the passphrase.",
      thanksIntro: "You can use either button below. If you’re on a phone, it will open your apps automatically.",
      smsButton: `Text ${CONTACT_NAME} (SMS)`,
      emailButton: "Email a story",
      desktopHint: "If you’re on a computer, the SMS button is disabled. Use the email button or copy the number below into your phone.",
      consent: `By sending a message/photo you consent to sharing it with ${PERSON}’s family. To remove or correct a submission, reply to ${CONTACT_NAME} or email `,
      fallbackLead: "Having trouble? You can copy these instead:",
      labelText: "Text:",
      labelEmail: "Email:",
      smsBody: `I have a story to share about ${PERSON}. (Feel free to attach a photo.)`,
      emailSubject: `Memory of ${PERSON}`,
      emailBody: "How you knew them:\nStory:\nPermission to share (Y/N):"
    };
    // ====================================================================

    // Document titles/headers
    document.getElementById('docTitle').textContent = `Share a Memory for ${PERSON}`;
    document.getElementById('gateTitle').textContent = `Share a Memory for ${PERSON}`;
    document.getElementById('thanksTitle').textContent = `Thank you for sharing a memory of ${PERSON}`;
    document.getElementById('gateIntro').textContent = STRINGS.gateIntro;
    document.getElementById('gateTip').textContent = STRINGS.gateTip;
    document.getElementById('thanksIntro').textContent = STRINGS.thanksIntro;

    // Elements
    const gate = document.getElementById('gate');
    const content = document.getElementById('content');
    const enter = document.getElementById('enter');
    const pw = document.getElementById('pw');
    const smsBtn = document.getElementById('smsBtn');
    const mailBtn = document.getElementById('mailBtn');
    const desktopHint = document.getElementById('desktopHint').firstElementChild;
    const addrSpan = document.getElementById('prettyEmail');
    const prettyPhone = document.getElementById('prettyPhone');
    const prettyEmail = document.getElementById('prettyEmail');
    const labelText = document.getElementById('labelText');
    const labelEmail = document.getElementById('labelEmail');

    // Set button labels and static lines
    smsBtn.textContent = STRINGS.smsButton;
    mailBtn.textContent = STRINGS.emailButton;
    desktopHint.textContent = STRINGS.desktopHint;
    document.getElementById('consentLine').innerHTML = `${STRINGS.consent}<span id="addr"></span>.`;
    document.getElementById('fallbackLead').textContent = STRINGS.fallbackLead;
    labelText.textContent = STRINGS.labelText;
    labelEmail.textContent = STRINGS.labelEmail;

    // UA detection
    const ua = navigator.userAgent || "";
    const isIOS = /iPad|iPhone|iPod/.test(ua);
    const isAndroid = /Android/.test(ua);
    const isMobile = isIOS || isAndroid;
    const BODY = encodeURIComponent(STRINGS.smsBody);

    function buildSmsHref() {
      if (isIOS) return `sms:${PHONE}&body=${BODY}`;
      if (isAndroid) return `smsto:${PHONE}:${BODY}`;
      return `sms:${PHONE}?body=${BODY}`; // desktop fallback (usually ignored)
    }

    function prettyUK(e164) {
      if (!e164.startsWith("+44")) return e164;
      const rest = e164.slice(3);
      // basic UK mobile spacing +44 #### ######
      return `+44 ${rest.slice(0,4)} ${rest.slice(4,9)} ${rest.slice(9)}`.trim();
    }

    function openIfMatch(){
      if ((pw.value || '').trim().toLowerCase() === PASS.toLowerCase()){
        gate.classList.add('hidden');
        content.classList.remove('hidden');

        // Links
        smsBtn.setAttribute('href', buildSmsHref());
        const mailHref = `mailto:${EMAIL}?subject=${encodeURIComponent(STRINGS.emailSubject)}&body=${encodeURIComponent(STRINGS.emailBody)}`;
        mailBtn.setAttribute('href', mailHref);

        // Visible text
        document.getElementById('addr').textContent = EMAIL;
        addrSpan.textContent = EMAIL;
        prettyEmail.textContent = EMAIL;
        prettyPhone.textContent = prettyUK(PHONE);

        // On desktop, disable SMS and show hint
        if (!isMobile) {
          smsBtn.classList.add('disabled');
          document.getElementById('desktopHint').classList.remove('hidden');
        }
      } else {
        alert("That passphrase didn't match. Please try again.");
        pw.focus();
      }
    }

    enter.addEventListener('click', openIfMatch);
    pw.addEventListener('keydown', e=>{ if(e.key==='Enter'){ openIfMatch(); }});
  </script>
</body>
</html>
